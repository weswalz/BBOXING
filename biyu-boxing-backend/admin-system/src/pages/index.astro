---
import { getCollection } from '../lib/mongodb.js';

// Test database connection
let connectionStatus = 'Testing...';
let error = null;

try {
  await getCollection('test');
  connectionStatus = 'Connected successfully!';
} catch (err) {
  connectionStatus = 'Connection failed';
  error = err.message;
}
---

<html>
  <head>
    <title>BiYu Boxing Admin - Setup Test</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
        background: #f5f5f5;
      }
      h1 {
        color: #333;
        font-size: 2.5rem;
        margin-bottom: 1rem;
      }
      h2 {
        color: #555;
        margin-top: 2rem;
      }
      .status {
        background: white;
        padding: 1.5rem;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        margin: 1rem 0;
      }
      .success {
        color: #22c55e;
        font-weight: bold;
      }
      .error {
        color: #ef4444;
        font-weight: bold;
      }
      ul {
        line-height: 2;
      }
      a {
        color: #3b82f6;
        text-decoration: none;
      }
      a:hover {
        text-decoration: underline;
      }
      .btn {
        display: inline-block;
        background: #3b82f6;
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        text-decoration: none;
        margin: 0.5rem 0.5rem 0.5rem 0;
        transition: background 0.2s;
      }
      .btn:hover {
        background: #2563eb;
      }
    </style>
  </head>
  <body>
    <h1>ðŸ¥Š BiYu Boxing Admin System</h1>
    
    <div class="status">
      <h2>Setup Status</h2>
      <p><strong>Database:</strong> <span class={connectionStatus === 'Connected successfully!' ? 'success' : 'error'}>{connectionStatus}</span></p>
      {error && <p class="error"><strong>Error:</strong> {error}</p>}
    </div>
    
    <div class="status">
      <h3>Quick Actions:</h3>
      <a href="/admin/login" class="btn">Admin Login</a>
      <a href="/test-db" class="btn">Test Database</a>
      <a href="/admin/dashboard?key=admin123" class="btn">Quick Access Dashboard</a>
    </div>
    
    <div class="status">
      <h3>Setup Checklist:</h3>
      <ul>
        <li>âœ… Astro project created</li>
        <li>âœ… Dependencies installed</li>
        <li>âœ… Environment configured</li>
        <li>âœ… MongoDB connection tested</li>
        <li>âœ… Authentication system ready</li>
        <li>ðŸ”„ Ready for Admin Layout System</li>
      </ul>
    </div>
    
    <div class="status">
      <h3>Next Steps:</h3>
      <ol>
        <li>Run <code>npm install</code> to install dependencies</li>
        <li>Start MongoDB: <code>brew services start mongodb/brew/mongodb-community</code></li>
        <li>Run <code>npm run dev</code> to start the development server</li>
        <li>Visit <a href="http://localhost:4321">http://localhost:4321</a></li>
      </ol>
    </div>
  </body>
</html>
